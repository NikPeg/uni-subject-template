# uni-subject-template

Шаблон репозитория для организации материалов по учебным дисциплинам. Включает структуру папок для теории, а также инструменты для конвертации документов.

## Назначение

Этот темплейт предназначен для:
- Организации учебных материалов по дисциплинам
- Структурированного хранения лекций (Theory)
- Конвертации DOCX документов в текстовый формат с автоматическим анализом изображений
- Работы с AI-ассистентами (например, Cursor AI) для обработки учебных материалов

## Структура проекта

```
uni-subject-template/
├── Theory/          # Материалы лекций и теоретического курса
├── convert_docx_to_txt.py  # Скрипт конвертации DOCX → TXT
├── requirements.txt  # Зависимости Python
└── README.md        # Этот файл
```

## Использование скрипта convert_docx_to_txt.py

Скрипт конвертирует DOCX файлы в текстовый формат с анализом изображений через OpenRouter API. Поддерживает работу с отдельными файлами и целыми папками.

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Настройка

1. Создайте файл `.env` в корне проекта:
```bash
LLM_TOKEN="your_openrouter_api_key_here"
VISION_MODEL="google/gemini-2.0-flash-001"  # Опционально, по умолчанию используется эта модель
```

2. Получите API ключ на [OpenRouter](https://openrouter.ai/)

### Использование

Скрипт поддерживает два режима работы:

#### Обработка папки (рекомендуемый способ)

Обработать все DOCX файлы в указанной папке:

```bash
python3 convert_docx_to_txt.py Theory
```

#### Обработка отдельного файла

Обработать конкретный DOCX файл:

```bash
python3 convert_docx_to_txt.py Theory/lecture1.docx
```

#### Обработка текущей директории

Если запустить скрипт без аргументов, он обработает все DOCX файлы в текущей директории:

```bash
cd Theory
python3 ../convert_docx_to_txt.py
```

**Что делает скрипт:**
- Находит все `.docx` файлы в указанной папке (или обрабатывает указанный файл)
- Извлекает текст и изображения из каждого файла
- Отправляет изображения в OpenRouter API для анализа и получения текстового описания
- Создает `.txt` файлы с полным содержимым документа рядом с исходными файлами

### Особенности

- **Автоматический анализ изображений**: Все изображения из DOCX автоматически анализируются AI и их описание добавляется в текстовый файл
- **Правильный порядок**: Скрипт сохраняет правильную последовательность текста и изображений
- **Пропуск существующих**: Если для DOCX файла уже существует TXT, он будет пропущен
- **Fallback режим**: Если `python-docx` не установлен, используется базовый XML парсинг

### Пример вывода

Для каждого изображения в документе будет создано описание вида:
```
[ИЗОБРАЖЕНИЕ 1: image1.png]
Подробное описание изображения, включая весь видимый текст, структуру диаграмм и графиков...
```

## Работа с папками

Папка `Theory` создана с файлом `.gitkeep`, чтобы она сохранялась в Git даже когда пустая. Вы можете:

- Добавлять в неё DOCX файлы лекций
- Запускать скрипт конвертации для обработки всех файлов в папке
- Организовывать материалы по темам в подпапках

## Конвертация PDF в DOCX

Если у вас есть материалы в формате PDF, их можно конвертировать в DOCX перед обработкой скриптом. Для этого можно использовать онлайн-сервис [iLovePDF](https://www.ilovepdf.com/pdf_to_word):

1. Перейдите на https://www.ilovepdf.com/pdf_to_word
2. Загрузите PDF файл
3. При необходимости включите OCR (если PDF содержит отсканированные страницы)
4. Скачайте полученный DOCX файл
5. Поместите его в папку `Theory`
6. Обработайте с помощью `convert_docx_to_txt.py`
